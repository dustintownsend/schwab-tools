/**
 * Test fixtures for option chain-related tests
 */
import type { OptionChain, CompactOptionChain, OptionContract } from "../../src/schemas/index.js";

export const mockOptionContract: OptionContract = {
  symbol: "AAPL  240119C00180000",
  description: "AAPL Jan 19 2024 180 Call",
  bid: 3.50,
  ask: 3.70,
  last: 3.60,
  mark: 3.60,
  volume: 1500,
  openInterest: 25000,
  strikePrice: 180,
  expirationDate: "2024-01-19",
  daysToExpiration: 4,
  putCall: "CALL",
  inTheMoney: false,
  multiplier: 100,
  delta: 0.45,
  gamma: 0.05,
  theta: -0.15,
  vega: 0.25,
  rho: 0.02,
  impliedVolatility: 0.35,
  theoreticalValue: 3.55,
  timeValue: 3.55,
  intrinsicValue: 0,
};

export const mockOptionChain: OptionChain = {
  symbol: "AAPL",
  underlyingPrice: 178.52,
  volatility: 0.32,
  numberOfContracts: 1200,
  callExpDateMap: {
    "2024-01-19:4": {
      "175.0": [
        {
          ...mockOptionContract,
          symbol: "AAPL  240119C00175000",
          description: "AAPL Jan 19 2024 175 Call",
          strikePrice: 175,
          bid: 5.20,
          ask: 5.40,
          last: 5.30,
          mark: 5.30,
          delta: 0.62,
          inTheMoney: true,
          intrinsicValue: 3.52,
          timeValue: 1.78,
        },
      ],
      "180.0": [
        {
          ...mockOptionContract,
          strikePrice: 180,
        },
      ],
      "185.0": [
        {
          ...mockOptionContract,
          symbol: "AAPL  240119C00185000",
          description: "AAPL Jan 19 2024 185 Call",
          strikePrice: 185,
          bid: 2.10,
          ask: 2.30,
          last: 2.20,
          mark: 2.20,
          delta: 0.28,
        },
      ],
    },
  },
  putExpDateMap: {
    "2024-01-19:4": {
      "175.0": [
        {
          ...mockOptionContract,
          symbol: "AAPL  240119P00175000",
          description: "AAPL Jan 19 2024 175 Put",
          strikePrice: 175,
          putCall: "PUT",
          bid: 1.50,
          ask: 1.70,
          last: 1.60,
          mark: 1.60,
          delta: -0.38,
          inTheMoney: false,
        },
      ],
      "180.0": [
        {
          ...mockOptionContract,
          symbol: "AAPL  240119P00180000",
          description: "AAPL Jan 19 2024 180 Put",
          strikePrice: 180,
          putCall: "PUT",
          bid: 3.00,
          ask: 3.20,
          last: 3.10,
          mark: 3.10,
          delta: -0.55,
          inTheMoney: true,
          intrinsicValue: 1.48,
          timeValue: 1.62,
        },
      ],
      "185.0": [
        {
          ...mockOptionContract,
          symbol: "AAPL  240119P00185000",
          description: "AAPL Jan 19 2024 185 Put",
          strikePrice: 185,
          putCall: "PUT",
          bid: 5.80,
          ask: 6.00,
          last: 5.90,
          mark: 5.90,
          delta: -0.72,
          inTheMoney: true,
          intrinsicValue: 6.48,
          timeValue: -0.58,
        },
      ],
    },
  },
};

export const mockCompactOptionChain: CompactOptionChain = {
  symbol: "AAPL",
  underlyingPrice: 178.52,
  expirations: [
    {
      date: "2024-01-19",
      daysToExpiration: 4,
      calls: [
        {
          symbol: "AAPL  240119C00175000",
          strike: 175,
          bid: 5.20,
          ask: 5.40,
          mid: 5.30,
          volume: 1500,
          openInterest: 25000,
          itm: true,
          delta: 0.62,
          iv: 0.35,
        },
        {
          symbol: "AAPL  240119C00180000",
          strike: 180,
          bid: 3.50,
          ask: 3.70,
          mid: 3.60,
          volume: 1500,
          openInterest: 25000,
          itm: false,
          delta: 0.45,
          iv: 0.35,
        },
        {
          symbol: "AAPL  240119C00185000",
          strike: 185,
          bid: 2.10,
          ask: 2.30,
          mid: 2.20,
          volume: 1500,
          openInterest: 25000,
          itm: false,
          delta: 0.28,
          iv: 0.35,
        },
      ],
      puts: [
        {
          symbol: "AAPL  240119P00175000",
          strike: 175,
          bid: 1.50,
          ask: 1.70,
          mid: 1.60,
          volume: 1500,
          openInterest: 25000,
          itm: false,
          delta: -0.38,
          iv: 0.35,
        },
        {
          symbol: "AAPL  240119P00180000",
          strike: 180,
          bid: 3.00,
          ask: 3.20,
          mid: 3.10,
          volume: 1500,
          openInterest: 25000,
          itm: true,
          delta: -0.55,
          iv: 0.35,
        },
        {
          symbol: "AAPL  240119P00185000",
          strike: 185,
          bid: 5.80,
          ask: 6.00,
          mid: 5.90,
          volume: 1500,
          openInterest: 25000,
          itm: true,
          delta: -0.72,
          iv: 0.35,
        },
      ],
    },
  ],
};

/**
 * Mock Schwab API option chain response
 */
export const mockSchwabOptionChainResponse = {
  symbol: "AAPL",
  status: "SUCCESS",
  underlying: {
    symbol: "AAPL",
    description: "Apple Inc",
    change: 2.50,
    percentChange: 1.42,
    close: 176.02,
    quoteTime: 1705344000000,
    tradeTime: 1705343998000,
    bid: 178.50,
    ask: 178.55,
    last: 178.52,
    mark: 178.53,
    markChange: 2.51,
    markPercentChange: 1.43,
    bidSize: 100,
    askSize: 100,
    highPrice: 179.00,
    lowPrice: 175.50,
    openPrice: 176.00,
    totalVolume: 52000000,
    exchangeName: "NASDAQ",
    fiftyTwoWeekHigh: 199.62,
    fiftyTwoWeekLow: 164.08,
    delayed: false,
  },
  strategy: "SINGLE",
  interval: 0,
  isDelayed: false,
  isIndex: false,
  daysToExpiration: 0,
  interestRate: 0.05,
  underlyingPrice: 178.52,
  volatility: 32.0,
  numberOfContracts: 1200,
  callExpDateMap: {
    "2024-01-19:4": {
      "180.0": [
        {
          putCall: "CALL",
          symbol: "AAPL  240119C00180000",
          description: "AAPL Jan 19 2024 180 Call",
          exchangeName: "OPR",
          bid: 3.50,
          ask: 3.70,
          last: 3.60,
          mark: 3.60,
          bidSize: 50,
          askSize: 25,
          bidAskSize: "50X25",
          lastSize: 10,
          highPrice: 4.00,
          lowPrice: 3.00,
          openPrice: 3.20,
          closePrice: 3.15,
          totalVolume: 1500,
          tradeDate: null,
          tradeTimeInLong: 1705343000000,
          quoteTimeInLong: 1705344000000,
          netChange: 0.45,
          volatility: 35.0,
          delta: 0.45,
          gamma: 0.05,
          theta: -0.15,
          vega: 0.25,
          rho: 0.02,
          openInterest: 25000,
          timeValue: 3.55,
          theoreticalOptionValue: 3.55,
          theoreticalVolatility: 35.0,
          strikePrice: 180,
          expirationDate: "2024-01-19",
          daysToExpiration: 4,
          expirationType: "R",
          lastTradingDay: 1705708800000,
          multiplier: 100,
          settlementType: "P",
          deliverableNote: "",
          isIndexOption: null,
          percentChange: 14.29,
          markChange: 0.45,
          markPercentChange: 14.29,
          intrinsicValue: 0,
          pennyPilot: true,
          nonStandard: false,
          inTheMoney: false,
          mini: false,
        },
      ],
    },
  },
  putExpDateMap: {
    "2024-01-19:4": {
      "180.0": [
        {
          putCall: "PUT",
          symbol: "AAPL  240119P00180000",
          description: "AAPL Jan 19 2024 180 Put",
          exchangeName: "OPR",
          bid: 3.00,
          ask: 3.20,
          last: 3.10,
          mark: 3.10,
          bidSize: 40,
          askSize: 30,
          bidAskSize: "40X30",
          lastSize: 15,
          highPrice: 3.50,
          lowPrice: 2.50,
          openPrice: 2.80,
          closePrice: 2.75,
          totalVolume: 1200,
          tradeDate: null,
          tradeTimeInLong: 1705343000000,
          quoteTimeInLong: 1705344000000,
          netChange: 0.35,
          volatility: 36.0,
          delta: -0.55,
          gamma: 0.05,
          theta: -0.14,
          vega: 0.24,
          rho: -0.02,
          openInterest: 18000,
          timeValue: 1.62,
          theoreticalOptionValue: 3.08,
          theoreticalVolatility: 36.0,
          strikePrice: 180,
          expirationDate: "2024-01-19",
          daysToExpiration: 4,
          expirationType: "R",
          lastTradingDay: 1705708800000,
          multiplier: 100,
          settlementType: "P",
          deliverableNote: "",
          isIndexOption: null,
          percentChange: 12.73,
          markChange: 0.35,
          markPercentChange: 12.73,
          intrinsicValue: 1.48,
          pennyPilot: true,
          nonStandard: false,
          inTheMoney: true,
          mini: false,
        },
      ],
    },
  },
};
